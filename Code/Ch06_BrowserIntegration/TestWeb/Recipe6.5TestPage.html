<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<!-- saved from url=(0014)about:internet -->
<head>
    <title>Test Page for Recipe 6.5</title>
  <script type="text/javascript" src="js/System.Web.Extensions/1.0.61025.0/MicrosoftAjax.js"/>
    <script type="text/javascript" src="Silverlight.js"></script>
    <script type="text/javascript" src="/js/Recipe6.5.js"></script>
    
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
        
            var appSource = "";
            if (sender != null && sender != 0) {
                appSource = sender.getHost().Source;
            } 
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            var errMsg = "Unhandled Error in Silverlight 2 Application "
             +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError")
            {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError")
            {           
                if (args.lineNumber != 0)
                {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>
</head>

<body>
    <!-- Runtime errors from Silverlight will be displayed here.
	This will contain debugging information and should be removed or 
	hidden when debugging is completed -->
	<div id='errorLocation' style="font-size: small;color: Gray;"></div>
<span>Silverlight 2 has technology for interacting between the Silverlight 2 managed code and the hosting browser’s HTML DOM called the HTML Bridge.  The HTML Bridge enables developers to expose entire managed code types or just member functions of types for scripting in JavaScript.  
Developers can enable or disable HTML Bridge functionality by setting the enableHtmlAccess parameter on the Silverlight browser plug-in to a Boolean value, with the default as false or disabled.</span>
    <div id="silverlightControlHost" class="PositionControl">
		<object id="Xaml1" data="data:application/x-silverlight-2," type=
		"application/x-silverlight-2" width="100%" height="100%">
			<param name="source" value=
			 "ClientBin/Ch06_BrowserIntegration.Recipe6_5.xap"/>
			<param name="onerror" value="onSilverlightError" />
			<param name="minRuntimeVersion" value="2.0.31005.0" />
			<param name="autoUpgrade" value="true" />
      <param name="enableHtmlAccess" value="true" />
			<a href="http://go.microsoft.com/fwlink/?LinkID=124807" 
			style="text-decoration: none;">
     			<img src="http://go.microsoft.com/fwlink/?LinkId=108181" 
     			alt="Get Microsoft Silverlight" style="border-style: none"/>
			</a>
		</object>
		<iframe style='visibility:hidden;height:0;width:0;border:0px'></iframe>
    </div>
</body>
</html>
